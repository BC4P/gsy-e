



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the Grid Singularity Exchange">
      
      
        <link rel="canonical" href="https://gridsingularity.github.io/gsy-e/documentation/asset-api-template-script/">
      
      
        <meta name="author" content="Grid Singularity">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/Profile.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Asset API Template Script - Grid Singularity Wiki</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"PT Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://gridsingularity.github.io/gsy-e/documentation/" title="Grid Singularity Wiki" class="md-header-nav__button md-logo">
          
            <img src="../img/Profile.png" width="32" height="32">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Grid Singularity Wiki
            </span>
            <span class="md-header-nav__topic">
              Asset API Template Script
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/gridsingularity/gsy-e/wiki/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Grid Singularity Exchange
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://gridsingularity.github.io/gsy-e/documentation/" title="Grid Singularity Wiki" class="md-nav__button md-logo">
      
        <img src="../img/Profile.png" width="48" height="48">
      
    </a>
    Grid Singularity Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/gridsingularity/gsy-e/wiki/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Grid Singularity Exchange
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      General Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        General Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../documentation/" title="Grid Singularity Mission" class="md-nav__link">
      Grid Singularity Mission
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../technical-approach/" title="Grid Singularity Technical Approach" class="md-nav__link">
      Grid Singularity Technical Approach
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../development-path/" title="Grid Singularity Development Path" class="md-nav__link">
      Grid Singularity Development Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../licensing/" title="Licensing and Open Source Ethos" class="md-nav__link">
      Licensing and Open Source Ethos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Set up a simulation of an active local energy market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Set up a simulation of an active local energy market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Introduction to the Grid Singularity Exchange Interface: Singularity Map
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Introduction to the Grid Singularity Exchange Interface: Singularity Map
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../community/" title="Build a community" class="md-nav__link">
      Build a community
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-2" type="checkbox" id="nav-2-1-2">
    
    <label class="md-nav__link" for="nav-2-1-2">
      Assets configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-2">
        Assets configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../configuration/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../home/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../solar-panels/" title="Solar Panels (PVs)" class="md-nav__link">
      Solar Panels (PVs)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../consumption/" title="Consumption (Load Profiles)" class="md-nav__link">
      Consumption (Load Profiles)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../battery/" title="Battery (Storage)" class="md-nav__link">
      Battery (Storage)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../power-plant/" title="Power Plant" class="md-nav__link">
      Power Plant
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../community-settings/" title="Community Settings" class="md-nav__link">
      Community Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-market-settings/" title="Grid Market Settings" class="md-nav__link">
      Grid Market Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../events/" title="Events (Adding Assets, Communities, etc.)" class="md-nav__link">
      Events (Adding Assets, Communities, etc.)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-6" type="checkbox" id="nav-2-1-6">
    
    <label class="md-nav__link" for="nav-2-1-6">
      Results and Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-6">
        Results and Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../results-dashboard" title="Results dashboard" class="md-nav__link">
      Results dashboard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../results-community" title="Community" class="md-nav__link">
      Community
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bills-traded-energy/" title="Bills and traded energy" class="md-nav__link">
      Bills and traded energy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../self-sufficiency-self-consumption/" title="Self-Sufficiency and Self-Consumption" class="md-nav__link">
      Self-Sufficiency and Self-Consumption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trade-profile/" title="Trade profile" class="md-nav__link">
      Trade profile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../summary/" title="Summary" class="md-nav__link">
      Summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../price/" title="Price" class="md-nav__link">
      Price
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trades/" title="Trades" class="md-nav__link">
      Trades
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../results-download/" title="Results Download" class="md-nav__link">
      Results Download
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Instructions for researchers on backend code
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Instructions for researchers on backend code
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-1" type="checkbox" id="nav-2-2-1">
    
    <label class="md-nav__link" for="nav-2-2-1">
      Backend Installation Instructions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-1">
        Backend Installation Instructions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../linux-installation-instructions/" title="Linux Installation Instructions" class="md-nav__link">
      Linux Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ios-installation-instructions/" title="Mac Installation Instructions" class="md-nav__link">
      Mac Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vm-installation-instructions/" title="Virtual Machine Installation Instructions" class="md-nav__link">
      Virtual Machine Installation Instructions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version-update/" title="Version Updates" class="md-nav__link">
      Version Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-2" type="checkbox" id="nav-2-2-2">
    
    <label class="md-nav__link" for="nav-2-2-2">
      Backend Simulation Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-2">
        Backend Simulation Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../setup-configuration/" title="Setup Configuration" class="md-nav__link">
      Setup Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setting-configuration-parameters/" title="Setting General Configuration Parameters" class="md-nav__link">
      Setting General Configuration Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../market-backend-configuration/" title="Market Backend Configuration" class="md-nav__link">
      Market Backend Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../assets-installation/" title="Assets Installation" class="md-nav__link">
      Assets Installation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-3" type="checkbox" id="nav-2-2-3">
    
    <label class="md-nav__link" for="nav-2-2-3">
      Backend Results
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-3">
        Backend Results
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../backend-results-overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../backend-results-energy-bills/" title="Energy bills" class="md-nav__link">
      Energy bills
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requirements/" title="Data Requirements and File Upload Format" class="md-nav__link">
      Data Requirements and File Upload Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Market Mechanisms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Market Mechanisms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Market Types
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Market Types
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../market-types/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-2" type="checkbox" id="nav-3-1-2">
    
    <label class="md-nav__link" for="nav-3-1-2">
      Spot Market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-2">
        Spot Market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../spot-market-types/" title="Spot Maket Types" class="md-nav__link">
      Spot Maket Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../one-sided-pay-as-offer/" title="One-Sided Pay-as-Offer Market" class="md-nav__link">
      One-Sided Pay-as-Offer Market
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../two-sided-pay-as-bid/" title="Two-Sided Pay-as-Bid Market" class="md-nav__link">
      Two-Sided Pay-as-Bid Market
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../two-sided-pay-as-clear/" title="Two-Sided Pay-as-Clear Market" class="md-nav__link">
      Two-Sided Pay-as-Clear Market
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-3" type="checkbox" id="nav-3-1-3">
    
    <label class="md-nav__link" for="nav-3-1-3">
      Balancing Market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-3">
        Balancing Market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../balancing-market/" title="Balancing Market Structure" class="md-nav__link">
      Balancing Market Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../balancing-implementation/" title="Balancing Market Implementation" class="md-nav__link">
      Balancing Market Implementation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-4" type="checkbox" id="nav-3-1-4">
    
    <label class="md-nav__link" for="nav-3-1-4">
      Settlement Market
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-4">
        Settlement Market
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../settlement-market-structure/" title="Settlement Market Structure" class="md-nav__link">
      Settlement Market Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-4-2" type="checkbox" id="nav-3-1-4-2">
    
    <label class="md-nav__link" for="nav-3-1-4-2">
      Settlement Market Implementation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-1-4-2">
        Settlement Market Implementation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../markets-rotation/" title="Markets and rotation" class="md-nav__link">
      Markets and rotation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../assets-strategies/" title="Assets strategies" class="md-nav__link">
      Assets strategies
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../market-agent/" title="Bids/Offers Process and Hierarchical Market Structure" class="md-nav__link">
      Bids/Offers Process and Hierarchical Market Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../default-trading-strategy/" title="Trading Strategies" class="md-nav__link">
      Trading Strategies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Grid Fee Accounting
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Grid Fee Accounting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-fees/" title="Grid Fee Objectives" class="md-nav__link">
      Grid Fee Objectives
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../constant-fees/" title="Constant Grid Fee Calculation" class="md-nav__link">
      Constant Grid Fee Calculation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../percentage-fees/" title="Percentage Grid Fee Calculation" class="md-nav__link">
      Percentage Grid Fee Calculation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../degrees-of-freedom/" title="Degrees of Freedom" class="md-nav__link">
      Degrees of Freedom
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Collaborations and APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Collaborations and APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../collaboration/" title="Create a Grid Singularity Collaboration" class="md-nav__link">
      Create a Grid Singularity Collaboration
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Connect to the Grid Singularity APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Connect to the Grid Singularity APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../APIs-introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2" type="checkbox" id="nav-4-2-2" checked>
    
    <label class="md-nav__link" for="nav-4-2-2">
      Configure trading strategies through the Grid Singularity Asset API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-2">
        Configure trading strategies through the Grid Singularity Asset API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../configure-trading-strategies-walkthrough/" title="Walkthrough" class="md-nav__link">
      Walkthrough
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2-2" type="checkbox" id="nav-4-2-2-2" checked>
    
    <label class="md-nav__link" for="nav-4-2-2-2">
      Asset API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-2-2-2">
        Asset API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../asset-api-events/" title="Asset API Events" class="md-nav__link">
      Asset API Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../asset-api-commands/" title="Asset API Commands" class="md-nav__link">
      Asset API Commands
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
    <a href="./" title="Asset API Template Script" class="md-nav__link md-nav__link--active">
      Asset API Template Script
    </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2-3" type="checkbox" id="nav-4-2-2-3">
    
    <label class="md-nav__link" for="nav-4-2-2-3">
      Launch the Asset API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-2-2-3">
        Launch the Asset API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-asset-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-nav__link">
      Registration - Simulations run on the User-Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-asset-api-backend/" title="Registration - Simulations run on the Backend" class="md-nav__link">
      Registration - Simulations run on the Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-3" type="checkbox" id="nav-4-2-3">
    
    <label class="md-nav__link" for="nav-4-2-3">
      Implement dynamic grid fees through the Grid Singlarity Grid Operator API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-3">
        Implement dynamic grid fees through the Grid Singlarity Grid Operator API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../implement-grid-fees-walkthrough/" title="Walkthrough" class="md-nav__link">
      Walkthrough
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-3-2" type="checkbox" id="nav-4-2-3-2">
    
    <label class="md-nav__link" for="nav-4-2-3-2">
      Grid Operator API.
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-2-3-2">
        Grid Operator API.
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-operator-api-events/" title="Grid Operator API Events" class="md-nav__link">
      Grid Operator API Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-operator-api-commands/" title="Grid Operator API Commands" class="md-nav__link">
      Grid Operator API Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grid-operator-api-template-script/" title="Grid Operator API Template Script" class="md-nav__link">
      Grid Operator API Template Script
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-3-3" type="checkbox" id="nav-4-2-3-3">
    
    <label class="md-nav__link" for="nav-4-2-3-3">
      Launch the Grid Operator API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-2-3-3">
        Launch the Grid Operator API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-grid-operator-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-nav__link">
      Registration - Simulations run on the User-Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registration-grid-operator-api-backend/" title="Registration - Simulations run on the Backend" class="md-nav__link">
      Registration - Simulations run on the Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Grid Singularity Canary Test Network
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Grid Singularity Canary Test Network
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-ctn/" title="Connect to a Grid Singularity Canary Test Network" class="md-nav__link">
      Connect to a Grid Singularity Canary Test Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Send live energy asset data streams to the Grid Singularity exchange
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Send live energy asset data streams to the Grid Singularity exchange
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../connection-energy-assets/" title="Establish a connection with your energy assets" class="md-nav__link">
      Establish a connection with your energy assets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../send-data-exchange-sdk/" title="Send live data streams via the Exchange SDK" class="md-nav__link">
      Send live data streams via the Exchange SDK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../send-data-rest-api/" title="Send live data streams via the REST API" class="md-nav__link">
      Send live data streams via the REST API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../blockchain/" title="Blockchain Integration" class="md-nav__link">
      Blockchain Integration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../releases/" title="Releases Archive" class="md-nav__link">
      Releases Archive
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/gridsingularity/gsy-e/wiki/edit/master/docs/asset-api-template-script.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Asset API Template Script</h1>
                
                <p>A simple trading strategy is available in this <a href="https://github.com/gridsingularity/gsy-e-sdk/blob/master/gsy_e_sdk/setups/asset_api_template.py">template script</a>. This is a flexible and versatile Python script for easy modification and implementation of custom smart trading strategies. See the <code>TODO</code> flags there to see how to configure your trading strategy and extract market and asset data.</p>
<p>The first information to be gathered is the Market Maker price and Feed-in Tariff and calculate the average value between them. These values are required to set the boundaries of the pricing trading strategy.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># GET MARKET AND ENERGY FEATURES</span>
<span class="c1">################################################</span>
<span class="n">FiT_rate</span> <span class="o">=</span> <span class="n">market_info</span><span class="p">[</span><span class="s2">&quot;feed_in_tariff_rate&quot;</span><span class="p">]</span>
<span class="n">Market_Maker_rate</span> <span class="o">=</span> <span class="n">market_info</span><span class="p">[</span><span class="s2">&quot;market_maker_rate&quot;</span><span class="p">]</span>
<span class="n">Med_price</span> <span class="o">=</span> <span class="p">(</span><span class="n">Market_Maker_rate</span> <span class="o">-</span> <span class="n">FiT_rate</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">FiT_rate</span>
</code></pre></div>

<p>The Asset SDK Script stores energy assets information such as the energy requirements for the loads, the energy available for the PVs and the State Of Charge for the storage. This information when aggregated could be valuable when designing a smarter trading strategy.</p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">area_uuid</span><span class="p">,</span> <span class="n">area_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_grid_tree_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="s2">&quot;asset_info&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">area_dict</span> <span class="ow">or</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">if</span> <span class="s2">&quot;energy_requirement_kWh&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_energy_requirements</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_requirement_kWh&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;available_energy_kWh&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generation_energy_available</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;available_energy_kWh&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;used_storage&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_soc</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;used_storage&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;used_storage&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;free_storage&quot;</span><span class="p">])</span>
</code></pre></div>

<p>At the beginning of the script, the Exchange SDK creates a nested dictionary, containing various information for each asset (asset_strategy dictionary). First we get the name of the asset, the type (if it is a load, PV or storage) and the fees between the assets (also termed device in the code) and the market maker. The Oracle class has a function that calculates the grid fees along the path between two assets or markets in the grid: <a href="https://github.com/gridsingularity/gsy-e-sdk/blob/master/gsy_e_sdk/setups/asset_api_template.py#L109">calculate_grid_fee</a>. This function takes 3 arguments:</p>
<ul>
<li>start_market_or_asset_name: UUID of the started market/asset</li>
<li>target_market_or_asset_name: UUID of the targeted market/asset</li>
<li>fee_type: can either be "current_market_fee" or “last_market_fee”.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">area_uuid</span><span class="p">,</span> <span class="n">area_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_grid_tree_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="s2">&quot;asset_info&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">area_dict</span> <span class="ow">or</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;asset_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;area_name&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grid_fee</span><span class="p">(</span><span class="n">area_uuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_uuid_from_area_name</span><span class="p">(</span><span class="s2">&quot;Market Maker&quot;</span><span class="p">),</span> <span class="s2">&quot;current_market_fee&quot;</span><span class="p">)</span>  <span class="c1"># TODO change the string &quot;Market Maker&quot; with the name defined in the grid configuration, if needed</span>
</code></pre></div>

<p>These fees should be integrated in the pricing strategy in order to avoid any power outages for the loads and curtailment for the PVs. Lastly, in the asset_strategy dictionary, the pricing strategy is defined for each asset individually. This allows assets to have independent strategies depending on their information and location in the grid.</p>
<div class="codehilite"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grid_fee</span><span class="p">(</span><span class="n">area_uuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_uuid_from_area_name</span><span class="p">(</span><span class="s2">&quot;Market Maker&quot;</span><span class="p">),</span> <span class="s2">&quot;current_market_fee&quot;</span><span class="p">)</span>
</code></pre></div>

<p>The current pricing strategies are deterministic, representing a linear function bounded between the Feed-in Tariff-grid fee (lower boundary) and the Market Maker price + grid fee (upper boundary). Since the Exchange SDK can post up to 10 bids/offers per market slot, the strategies incrementally ramp up (bids) or down (offers) for a total of 10 prices per energy asset. The final bid/offer price is set at least 2 API available ticks before the end of the market slot length (9th and 10th tick in our case) to make sure that the bids and offers are placed before the market slot.</p>
<p>The load strategy, the PV strategy and the storage strategy, that can charge and discharge and therefore place bids and offers at the same time,are designed as follows.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Load strategy</span>
<span class="k">if</span> <span class="s1">&#39;energy_requirement_kWh&#39;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]:</span>
    <span class="n">load_strategy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ticks</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">load_strategy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span>
                <span class="n">FiT_rate</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">+</span>
                <span class="p">(</span><span class="n">Market_Maker_rate</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">FiT_rate</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">ticks</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">load_strategy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span>
                <span class="n">Market_Maker_rate</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">],</span> <span class="mi">3</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;buy_rates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_strategy</span>

<span class="c1"># Generation strategy</span>
<span class="k">if</span> <span class="s1">&#39;available_energy_kWh&#39;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]:</span>
    <span class="n">gen_strategy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ticks</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">gen_strategy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Market_Maker_rate</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">-</span>
                                <span class="p">(</span><span class="n">Market_Maker_rate</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">FiT_rate</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">ticks</span><span class="p">)),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gen_strategy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">FiT_rate</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]),</span> <span class="mi">3</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;sell_rates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gen_strategy</span>

<span class="c1"># Storage strategy</span>
<span class="k">if</span> <span class="s1">&#39;used_storage&#39;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]:</span>
    <span class="n">batt_buy_strategy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">batt_sell_strategy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
        <span class="n">batt_buy_strategy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">FiT_rate</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">Med_price</span> <span class="o">-</span> <span class="p">(</span><span class="n">FiT_rate</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">ticks</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">batt_sell_strategy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Market_Maker_rate</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">Market_Maker_rate</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;fee_to_market_maker&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">Med_price</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">ticks</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;buy_rates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batt_buy_strategy</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;sell_rates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batt_sell_strategy</span>
</code></pre></div>

<p>Later, the Asset SDK Script sends the first bid and/or offer for each energy asset. For each asset the API gets the energy requirements (load), available (storage) and energy to buy/sell (storage) through <em>latest_grid_tree_flat.items()</em> (which is the market_info dictionary flattened). For each asset’s bid/offer, the API applies the price defined in the asset_strategy dictionary. Once all the bids/offers commands have been set, the batch is executed.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># POST INITIAL BIDS AND OFFERS FOR MARKET SLOT</span>
<span class="c1">################################################</span>
<span class="c1"># takes the first element in each asset strategy to post the first bids and offers</span>
<span class="c1"># all bids and offers are aggregated in a single batch and then executed</span>
<span class="c1"># TODO how would you self-balance your managed energy assets?</span>
<span class="k">for</span> <span class="n">area_uuid</span><span class="p">,</span> <span class="n">area_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_grid_tree_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="s2">&quot;asset_info&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">area_dict</span> <span class="ow">or</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="c1"># Load strategy</span>
    <span class="k">if</span> <span class="s2">&quot;energy_requirement_kWh&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_requirement_kWh&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;buy_rates&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">energy</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_requirement_kWh&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">bid_energy_rate</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">)</span>

    <span class="c1"># Generation strategy</span>
    <span class="k">if</span> <span class="s2">&quot;available_energy_kWh&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;available_energy_kWh&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;sell_rates&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">energy</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;available_energy_kWh&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">offer_energy_rate</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">)</span>

    <span class="c1"># Battery strategy</span>
    <span class="k">if</span> <span class="s2">&quot;energy_to_buy&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]:</span>
        <span class="n">buy_energy</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_to_buy&quot;</span><span class="p">]</span>
        <span class="n">sell_energy</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_to_sell&quot;</span><span class="p">]</span>
        <span class="c1"># Battery buy strategy</span>
        <span class="k">if</span> <span class="n">buy_energy</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">buy_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;buy_rates&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">bid_energy_rate</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">buy_rate</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">buy_energy</span><span class="p">)</span>
        <span class="c1"># Battery sell strategy</span>
        <span class="k">if</span> <span class="n">sell_energy</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">sell_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;sell_rates&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">offer_energy_rate</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">sell_rate</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">sell_energy</span><span class="p">)</span>

<span class="n">response_slot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_batch_commands</span><span class="p">()</span>
</code></pre></div>

<p>At each on_tick event, the Asset API can post new bids and offers, or update / delete existing ones. This allows the Exchange SDK to update their price strategy until all consumption and generation have been traded. In the following lines the Exchange SDK updates the existing bids/offers with new prices to optimize trades. The updated energy information is found in <em>latest_grid_tree_flat.items()</em> and the prices for each bid/offer depends on the market slot progression. Once all commands are added to the batch, it is then executed.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># TRIGGERS EACH TICK</span>
<span class="c1">################################################</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Places a bid or an offer 10% of the market slot progression. The amount of energy</span>
<span class="sd">for the bid/offer depends on the available energy of the PV, the required</span>
<span class="sd">energy of the load, or the amount of energy in the battery and the energy already traded.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="k">def</span> <span class="nf">on_tick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tick_info</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tick_info</span><span class="p">[</span><span class="s1">&#39;slot_completion&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="n">ticks</span><span class="p">)</span>  <span class="c1"># tick num for index</span>

    <span class="c1">################################################</span>
    <span class="c1"># ADJUST BID AND OFFER STRATEGY (if needed)</span>
    <span class="c1">################################################</span>
    <span class="c1"># TODO manipulate tick strategy if required</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span>

    <span class="c1">################################################</span>
    <span class="c1"># UPDATE/REPLACE BIDS AND OFFERS EACH TICK</span>
    <span class="c1">################################################</span>
    <span class="k">for</span> <span class="n">area_uuid</span><span class="p">,</span> <span class="n">area_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_grid_tree_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;asset_info&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">area_dict</span> <span class="ow">or</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Load Strategy</span>
        <span class="k">if</span> <span class="s2">&quot;energy_requirement_kWh&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span>
            <span class="s2">&quot;energy_requirement_kWh&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;buy_rates&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">energy</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_requirement_kWh&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">bid_energy_rate</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">)</span>

        <span class="c1"># Generation strategy</span>
        <span class="k">if</span> <span class="s2">&quot;available_energy_kWh&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span>
            <span class="s2">&quot;available_energy_kWh&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;sell_rates&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">energy</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;available_energy_kWh&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">offer_energy</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="n">rate</span><span class="o">*</span><span class="n">energy</span><span class="p">,</span>
                                                    <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Battery strategy</span>
        <span class="k">if</span> <span class="s2">&quot;energy_to_buy&quot;</span> <span class="ow">in</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">]:</span>
            <span class="n">buy_energy</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_to_buy&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_active_in_offers&quot;</span><span class="p">]</span>
            <span class="n">sell_energy</span> <span class="o">=</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_to_sell&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">area_dict</span><span class="p">[</span><span class="s2">&quot;asset_info&quot;</span><span class="p">][</span><span class="s2">&quot;energy_active_in_bids&quot;</span><span class="p">]</span>

            <span class="c1"># Battery buy strategy</span>
            <span class="k">if</span> <span class="n">buy_energy</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">buy_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;buy_rates&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">bid_energy_rate</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">buy_rate</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">buy_energy</span><span class="p">)</span>

            <span class="c1"># Battery sell strategy</span>
            <span class="k">if</span> <span class="n">sell_energy</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">sell_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_strategy</span><span class="p">[</span><span class="n">area_uuid</span><span class="p">][</span><span class="s2">&quot;sell_rates&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_to_batch_commands</span><span class="o">.</span><span class="n">offer_energy</span><span class="p">(</span><span class="n">area_uuid</span><span class="o">=</span><span class="n">area_uuid</span><span class="p">,</span>
                                                        <span class="n">price</span><span class="o">=</span><span class="n">sell_rate</span><span class="o">*</span><span class="n">sell_energy</span><span class="p">,</span>
                                                        <span class="n">energy</span><span class="o">=</span><span class="n">sell_energy</span><span class="p">,</span>
                                                        <span class="n">replace_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">response_tick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_batch_commands</span><span class="p">()</span>
</code></pre></div>

<p>After that, the on_event_or_response is called. By default we do not perform any operation in this event but the user could add some if needed. For instance, the user could record all the trades responses received in that event.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># TRIGGERS EACH COMMAND RESPONSE AND EVENT</span>
<span class="c1">################################################</span>
<span class="k">def</span> <span class="nf">on_event_or_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="c1"># print(&quot;message&quot;,message)</span>
    <span class="k">pass</span>
</code></pre></div>

<p>Lastly, the Asset SDK Script overwrites the on_finish event so that whenever the function is triggered the script stops. If the user wishes to save some information recorded within the Exchange SDK, this would be the opportunity to export them to external files.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># SIMULATION TERMINATION CONDITION</span>
<span class="c1">################################################</span>
<span class="k">def</span> <span class="nf">on_finish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finish_info</span><span class="p">):</span>
    <span class="c1"># TODO export relevant information stored during the simulation (if needed)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>

<p>The rest of the SDK script is used to connect to the energy assets of a running simulation/collaboration/Canary Test Network. These lines should work as is and no changes are required.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">################################################</span>
<span class="c1"># REGISTER FOR DEVICES AND MARKETS</span>
<span class="c1">################################################</span>
<span class="k">def</span> <span class="nf">get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to parse the grid tree and returned all registered assets</span>
<span class="sd">    wrapper for _get_assets_name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">indict</span> <span class="o">==</span> <span class="p">{}:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="n">outdict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Area&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;Load&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;PV&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;Storage&quot;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="n">_get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">,</span> <span class="n">outdict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outdict</span>


<span class="k">def</span> <span class="nf">_get_assets_name</span><span class="p">(</span><span class="n">indict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">outdict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse the collaboration / Canary Network registry</span>
<span class="sd">    Returns a list of the Market, Load, PV and Storage names the user is registered to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">indict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span>
            <span class="n">area_type</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;registered&quot;</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">outdict</span><span class="p">[</span><span class="n">area_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;children&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">children</span> <span class="ow">in</span> <span class="n">indict</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="n">_get_assets_name</span><span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">outdict</span><span class="p">)</span>


<span class="n">aggr</span> <span class="o">=</span> <span class="n">Oracle</span><span class="p">(</span><span class="n">aggregator_name</span><span class="o">=</span><span class="n">oracle_name</span><span class="p">)</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_RUN_ON_REDIS&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
    <span class="n">DeviceClient</span> <span class="o">=</span> <span class="n">RedisDeviceClient</span>
    <span class="n">device_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;autoregister&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;pubsub_thread&quot;</span><span class="p">:</span> <span class="n">aggr</span><span class="o">.</span><span class="n">pubsub</span><span class="p">}</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">DeviceClient</span> <span class="o">=</span> <span class="n">RestDeviceClient</span>
    <span class="n">simulation_id</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_SIMULATION_ID&quot;</span><span class="p">]</span>
    <span class="n">domain_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_DOMAIN_NAME&quot;</span><span class="p">]</span>
    <span class="n">websockets_domain_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_WEBSOCKET_DOMAIN_NAME&quot;</span><span class="p">]</span>
    <span class="n">device_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;autoregister&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;start_websocket&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">automatic</span><span class="p">:</span>
        <span class="n">registry</span> <span class="o">=</span> <span class="n">aggr</span><span class="o">.</span><span class="n">get_configuration_registry</span><span class="p">()</span>
        <span class="n">registered_assets</span> <span class="o">=</span> <span class="n">get_assets_name</span><span class="p">(</span><span class="n">registry</span><span class="p">)</span>
        <span class="n">load_names</span> <span class="o">=</span> <span class="n">registered_assets</span><span class="p">[</span><span class="s2">&quot;Load&quot;</span><span class="p">]</span>
        <span class="n">pv_names</span> <span class="o">=</span> <span class="n">registered_assets</span><span class="p">[</span><span class="s2">&quot;PV&quot;</span><span class="p">]</span>
        <span class="n">storage_names</span> <span class="o">=</span> <span class="n">registered_assets</span><span class="p">[</span><span class="s2">&quot;Storage&quot;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">register_device_list</span><span class="p">(</span><span class="n">asset_names</span><span class="p">,</span> <span class="n">asset_args</span><span class="p">,</span> <span class="n">asset_uuid_map</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">asset_names</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Registered device:&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_RUN_ON_REDIS&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
            <span class="n">asset_args</span><span class="p">[</span><span class="s1">&#39;area_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="n">get_area_uuid_from_area_name_and_collaboration_id</span><span class="p">(</span><span class="n">simulation_id</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">domain_name</span><span class="p">)</span>
            <span class="n">asset_args</span><span class="p">[</span><span class="s1">&#39;area_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uuid</span>
            <span class="n">asset_uuid_map</span><span class="p">[</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
        <span class="n">asset</span> <span class="o">=</span> <span class="n">DeviceClient</span><span class="p">(</span><span class="o">**</span><span class="n">asset_args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;API_CLIENT_RUN_ON_REDIS&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
            <span class="n">asset_uuid_map</span><span class="p">[</span><span class="n">asset</span><span class="o">.</span><span class="n">area_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">asset</span><span class="o">.</span><span class="n">area_id</span>
        <span class="n">asset</span><span class="o">.</span><span class="n">select_aggregator</span><span class="p">(</span><span class="n">aggr</span><span class="o">.</span><span class="n">aggregator_uuid</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">asset_uuid_map</span>


<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Registering assets ...&#39;</span><span class="p">)</span>
<span class="n">asset_uuid_map</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">asset_uuid_map</span> <span class="o">=</span> <span class="n">register_device_list</span><span class="p">(</span><span class="n">load_names</span><span class="p">,</span> <span class="n">device_args</span><span class="p">,</span> <span class="n">asset_uuid_map</span><span class="p">)</span>
<span class="n">asset_uuid_map</span> <span class="o">=</span> <span class="n">register_device_list</span><span class="p">(</span><span class="n">pv_names</span><span class="p">,</span> <span class="n">device_args</span><span class="p">,</span> <span class="n">asset_uuid_map</span><span class="p">)</span>
<span class="n">asset_uuid_map</span> <span class="o">=</span> <span class="n">register_device_list</span><span class="p">(</span><span class="n">storage_names</span><span class="p">,</span> <span class="n">device_args</span><span class="p">,</span> <span class="n">asset_uuid_map</span><span class="p">)</span>
<span class="n">aggr</span><span class="o">.</span><span class="n">device_uuid_map</span> <span class="o">=</span> <span class="n">asset_uuid_map</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Summary of assets registered:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aggr</span><span class="o">.</span><span class="n">device_uuid_map</span><span class="p">)</span>

<span class="c1"># loop to allow persistence</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">aggr</span><span class="o">.</span><span class="n">is_finished</span><span class="p">:</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<p>Please find the following tutorial describing the required steps to run the asset API locally and on a collaboration:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/oCcQ6pYFd5w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p><em>The next step is to adapt the <a href="https://github.com/gridsingularity/gsy-e-sdk/blob/master/gsy_e_sdk/setups/asset_api_template.py">Asset API template</a> script developed by Grid Singularity to customize the trading strategies as you wish!</em></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../asset-api-commands/" title="Asset API Commands" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Asset API Commands
              </span>
            </div>
          </a>
        
        
          <a href="../registration-asset-api-user-interface/" title="Registration - Simulations run on the User-Interface" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Registration - Simulations run on the User-Interface
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-logo">
        <img src="../img/New_Logo2.0.png" height="50"/>
      </div>
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/gridsingularity" class="md-footer-social__link fa fa-lg fa-github"></a>
    
      <a href="https://twitter.com/gridsingularity" class="md-footer-social__link fa fa-lg fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/grid-singularity" class="md-footer-social__link fa fa-lg fa-linkedin"></a>
    
      <a href="https://join.slack.com/t/gsycommunity/shared_invite/zt-dpfxe2gk-hKFccsrr68g982odCJlrIg" class="md-footer-social__link fa fa-lg fa-slack"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.05d1c8d6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="https://research.web3.foundation/en/latest/mathjax-config.js"></script>
      
        <script src="../search/main.js"></script>
      
    
  </body>
</html>